### synchronized关键字主要的三种使用方式
* 修饰实例方法 作用于当前对象实例加所，进入同步代码前要获得当前对象实例的锁
* 修饰静态方法 访问静态synchronized方法占用的锁是当前类的锁，而访问非静态synchronized方法占用的锁是当前实例对象锁
* 修饰代码块 
修饰实例对象 被锁的对象是类的实例对象
修饰class对象 被锁的对象是类对象
修饰任意实例对象object 被锁的对象是实例对象object
![synchronized关键字主要应用方式](https://img-blog.csdn.net/20180909145934940?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTI5OTgyNTQ=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70 "synchronized关键字主要应用方式")
### 幂等性
要求每次请求不会对资源或者数据产生影响
***
* 什么情况下需要保障幂等性？
```java
Select * from table where id = 2
无论执行多少次都不会对资源造成副作用，所以可以说是天然的幂等

Update table set status =1 where id =2
无论执行成功多少次状态都是一致的，第一次执行成功对资源造成的副作用和多次执行成功对数据造成的副作用是一样的。因此可以说这种场景也是幂等操作

Update table set version = version+1 where id = 2
每次执行的结果都会发生变化，也就是说对资源造成了副作用，这种不是幂等的。这种情况如果想要保证幂等，语句可以这么写：update table set version = version+1 where id = 2 and version = 1.这样就可以保证幂等了。
```
* 什么情况下需要使用幂等?
我们发起支付的时候向支付宝支付请求，无论是交易系统自身bug还是交易系统与支付宝之间的网络问题导致重复发送，支付宝应该并且必须只能扣用户一次钱的。在这种需求下的系统在设计的时候，我们就需要将系统或者服务设计成幂等的。
* 幂等的不足
通过上面我们知道了幂等服务是以牺牲服务提供者逻辑和成本为代价的。所以，是否有必要，需要根据具体场景具体来分析的。因此除了业务上的特殊要求外，尽量不要提供幂等的接口。
1：增加了额外的控制幂等的业务逻辑，复杂了业务功能；
2：把并行执行的功能改为串行执行，这样就降低了执行的效率。
* 接口幂等性
各类微服务之间通讯 无论是rpc或者restful，都需要在请求或者操作后，保证处理数据的结果是统一的。
